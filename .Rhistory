theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
scatterplot <- ggplot(df, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
scatterplot <- ggplot(df, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
co <- c("mistyrose2", "lavender") #make my own color palette
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = c("mistyrose2", "lavender")) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
setwd("../103RFinalProject") # set working directory
expressiondf <- read.csv(file = "QBS103_finalProject_geneExpression.csv", header = TRUE) # read data from csv file to make df
metadf <- read.csv(file = "QBS103_finalProject_metadata.csv", header = TRUE) # read data from csv file to make another df
library(tidyverse) # I am using Tidyverse in this project
longexpressiondf <- expressiondf %>% # create a new df that is the long version of our original dataset
pivot_longer(cols = starts_with(c("COVID", "NONCOVID")),
names_to = "participant_id",
values_to = "gene_expression_data")
list_df = list(longexpressiondf, metadf) # link the two dfs together by using list() then reduce()
df <- list_df %>% reduce(inner_join, by='participant_id')
library(ggplot2) # we are using ggplot2 in this project
subset <- subset(df, X == 'CLEC3B') # create a subset of the dat that includes only the gene of interest
subset
histogramplot <- ggplot(subset, aes(x = gene_expression_data)) + # build a histogram plot of gene expression and frequency
geom_histogram(color = "pink", fill = "magenta") +
labs(title = "CLEC3B Gene Expression", y = "Frequency", x = expression(paste(italic("CLEC3B"), " Gene Expression"))) +
theme(plot.title = element_text(colour = "orange1", face = "bold", hjust = 0.5)) # for the plot title
histogramplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
co <- c("mistyrose2", "lavender") #make my own color palette
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co, color = co2) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co, color = c("pink", "purple")) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co, color = c("pink", "purple")) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(color = c("pink", "purple")) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = age, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
charlson_binary =
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
co2 <- c("pink", "purple")
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
subset[charlson_score]
subset$charlson_score
subset$charlson_score > 5
subset
subset$charlson_binary <- subset$charlson_score > 5
subset
subset$charlson_binary
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = subset$charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_score, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(fill = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Score") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") #make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(color = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(color = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
coord_flip() +
scale_fill_manual(labels=c("<5", ">5"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(color = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot(color = co) +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip()
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip()
boxplot + scale_x_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5"))
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip()
boxplot + scale_x_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_x_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5 (Extreme)"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5 \n(Extreme)"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)"))
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() #+
#scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) #+
#coord_flip() #+
#scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
#coord_flip() #+
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() #+
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = charlson_binary, y = gene_expression_data, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() +
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() + # gene expression should actually be on the y axis
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
library(ggplot2) # we are using ggplot2 in this project
subset <- subset(df, X == 'CLEC3B') # create a subset of the dat that includes only the gene of interest
subset
histogramplot <- ggplot(subset, aes(x = gene_expression_data)) + # build a histogram plot of gene expression and frequency
geom_histogram(color = "pink", fill = "magenta") +
labs(title = "CLEC3B Gene Expression", y = "Frequency", x = expression(paste(italic("CLEC3B"), " Gene Expression"))) +
theme(plot.title = element_text(colour = "orange1", face = "bold", hjust = 0.5)) # for the plot title
histogramplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.9)) # for the plot title
scatterplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.8)) # for the plot title
scatterplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.7)) # for the plot title
scatterplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.6)) # for the plot title
scatterplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() + # gene expression should actually be on the y axis
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
View(df)
genes = c('CLEC3B', 'APOA1')
subset(df, X == genes)
make_plot_function <- function(df, genes, contvar, list2catvars){
# only select data for relevant genes
subset <- subset(df, X == genes)
histogramplot <- ggplot(subset, aes(x = contvar)) + # build a histogram plot of gene expression and frequency
geom_histogram(color = "pink", fill = "magenta") +
labs(title = "Gene Continuous Variable vs Frequency", y = "Frequency", x = expression(paste(italic("Gene"), " Continuous Variable"))) +
theme(plot.title = element_text(colour = "orange1", face = "bold", hjust = 0.5)) # for the plot title
histogramplot
}
make_plot_function(df, "CLEC3B", "gene_expression_data", c("charlson_binary", "mechanical_ventilation"))
setwd("../103RFinalProject") # set working directory
expressiondf <- read.csv(file = "QBS103_finalProject_geneExpression.csv", header = TRUE) # read data from csv file to make df
metadf <- read.csv(file = "QBS103_finalProject_metadata.csv", header = TRUE) # read data from csv file to make another df
library(tidyverse) # I am using Tidyverse in this project
longexpressiondf <- expressiondf %>% # create a new df that is the long version of our original dataset
pivot_longer(cols = starts_with(c("COVID", "NONCOVID")),
names_to = "participant_id",
values_to = "gene_expression_data")
list_df = list(longexpressiondf, metadf) # link the two dfs together by using list() then reduce()
df <- list_df %>% reduce(inner_join, by='participant_id')
library(ggplot2) # we are using ggplot2 in this project
subset <- subset(df, X == 'CLEC3B') # create a subset of the df that includes only the gene of interest
subset
histogramplot <- ggplot(subset, aes(x = gene_expression_data)) + # build a histogram plot of gene expression and frequency
geom_histogram(color = "pink", fill = "magenta") +
labs(title = "CLEC3B Gene Expression", y = "Frequency", x = expression(paste(italic("CLEC3B"), " Gene Expression"))) +
theme(plot.title = element_text(colour = "orange1", face = "bold", hjust = 0.5)) # for the plot title
histogramplot
scatterplot <- ggplot(subset, aes(x = gene_expression_data, y = ventilator.free_days)) +  # build a scatter plot of gene expression and ventilator days
labs(title = "CLEC3B Gene Expression and Ventilator Days", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Ventilator Free Days") +
geom_point(color = "purple", alpha = 0.5) +
theme(plot.title = element_text(colour = "darkmagenta", face = "bold", hjust = 0.6)) # for the plot title
scatterplot
co <- c("mistyrose2", "lavender") # make my own color palette
subset$charlson_binary <- subset$charlson_score > 5 # make a new column that has T if the Charlson Score is extreme (more than 5) else it is F
boxplot <- ggplot(subset, aes(x = gene_expression_data, y = charlson_binary, color = mechanical_ventilation)) + #create a boxplot of gene expression, charlson score, and mechanical ventilation
geom_boxplot() +
geom_jitter() +
labs(title = "CLEC3B Gene Expression, Charlson Score, \nand Mechanical Ventilation", x = expression(paste(italic("CLEC3B"), " Gene Expression"), y = "Frequency"), y = "Charlson Binary") +
theme(plot.title = element_text(colour = "orangered", face = "bold", hjust = 0.3)) + # for the plot title
scale_fill_manual(labels=c("<5", ">5")) +
coord_flip() + # gene expression should actually be on the y axis
scale_y_discrete(labels=c("FALSE" = "Less than 5", "TRUE" = "More than 5\n(Extreme)")) # name the x axis by ><5
boxplot
#testing to make subset. goes in the function below
genes = c('CLEC3B', 'APOA1')
for (gene in genes){
subset$gene <- subset(df, X == genes)
}
